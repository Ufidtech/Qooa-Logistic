<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Forgot Password - QOOA</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body style="display:flex;align-items:center;justify-content:center;min-height:100vh;background:#f3f4f6;">
    <div style="background:#fff;padding:28px;border-radius:12px;max-width:420px;width:100%;box-shadow:0 10px 20px rgba(0,0,0,0.08);">
      <h2 style="margin-bottom:8px;color:#1f2937;">Reset your password</h2>
      <p style="margin-bottom:16px;color:#6b7280;">Enter the email you used to register and we'll send reset instructions.</p>
      <form id="forgotForm">
        <div style="margin-bottom:12px;">
          <label for="fp-email" style="display:block;margin-bottom:6px;color:#374151;">Email address</label>
          <input id="fp-email" type="email" required style="width:100%;padding:10px 12px;border-radius:6px;border:1px solid #e5e7eb;" />
        </div>
        <div style="display:flex;gap:8px;justify-content:flex-end;">
          <a href="login.html" style="align-self:center;color:#6b7280;text-decoration:none;">Back to login</a>
          <button type="submit" class="btn-primary" style="padding:10px 16px;background:#10b981;color:#fff;border:none;border-radius:8px;">Send reset email</button>
        </div>
      </form>
      <div id="fp-msg" style="margin-top:12px;color:#059669;display:none;">If the email exists we'll send reset instructions shortly.</div>
    </div>

    <script>
      const BACKEND_URL = window.BACKEND_URL || 'http://localhost:3000';

      document.getElementById('forgotForm').addEventListener('submit', async function(e){
        e.preventDefault();
        const email = document.getElementById('fp-email').value;
        const msgEl = document.getElementById('fp-msg');
        msgEl.style.display = 'none';

        try {
          const res = await fetch(`${BACKEND_URL}/api/auth/forgot-password`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email }),
          });

          const data = await res.json().catch(() => ({}));

          if (!res.ok) {
            alert(data.message || 'Unable to send reset email');
            return;
          }

          msgEl.style.display = 'block';
        } catch (err) {
          console.error(err);
          alert('Network error');
        }
      });
    </script>
  </body>
</html>